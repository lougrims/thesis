\Section{The Goman and Khrabrov model}

\Subsection{Motivation}
In their 1994 paper entitled ``State-Space Representation of Aerodynamic Characteristics of an Aircraft at High Angle of Attack'' \cite{GK} Goman and Khrabrov introduce a new model for characterizing the lift and moment coefficients for slender delta wings.
Their goal was to study the stability of delta wing fighter jets where maneuverability is important, and to link it to physical fluid dynamic phenomenons such as vortex breakdown or flow separation.

\par The classical stability analysis method relies on a Taylor series expansion of the aerodynamic coefficients.
% maybe put an example here.
This linear representation is relatively accurate for fully attached flow but the model breaks down at higher angle of attack when separation occurs.
In the semi separated region the aerodynamic effects are mainly driven by the degree of flow separation happening on the wing.
For this reason they chose to define $C_l$ as a function of $\alpha$, the angle of attack, and a state variable $x$ representing the degree of separation.
This degree of separation can be defined as the position of the vortex breakdown point if you are looking at delta wings, or the position of the reattachment point in the case of 2D airfoils.
This allows for a model tightly defined by the physics of the flow.


\Subsection{Flow physics and state variables}
Since this study was performed with a 2D NACA0009 airfoil, we define the state variable $x$ as the position of the reattachment point.
Its value linearly change from 1 when it is situated at the leading edge to 0 when it gets to the trailing edge and beyond.
For quasi-steady cases separation point is a function of the angle of attack. If we define $x_0$ as the separation point position in a quasi-steady situation then

\begin{equation}
  C_l^{qs} = f(\alpha,x_0(\alpha))
  \label{eqn:qs_Cl}
\end{equation}

The unsteady part of the flow physics can be divided into two groups of phenomenons.

\par The firsts are the effects of the angle of attack variation speed on the position of the separation point.
Goman and Khrabrov argue that this is roughly proportional to the pitch rate $\dot{\alpha}$ and as such they can be included by modifying the quasi-steady state value by using $x_0 (\alpha - \tau_2 \dot{\alpha})$ 

\par The second phenomenon is due to the dynamics of the separated flow.
The flow has a certain relaxation characteristic under a disturbance input.
This can be modeled using a first order differential equation.

\begin{eqnarray}
  \tau_1 \frac{dx}{dt} +x = x_0(\alpha - \tau_2 \dot{\alpha}) 
  \label{eqn:state_variable}
\end{eqnarray}



\Section{Experimental Setup}

\Subsection{Equipment and facilities}
\begin{figure}[h]
  \begin{center}
		%\includegraphics{<+file+>}
  \end{center}
  \caption{Airfoil model inside the wind tunnel}
  \label{fig:wind_tunnel}
\end{figure}

All of the experimental part of this research was performed into the Andrew Fejer Unsteady Wind Tunnel at the Illinois Institute of Technology, Chicago.
This is a low velocity wind tunnel with a 60cm by 60cm test section.
The wind tunnel is mainly used for unsteady aerodynamic studies.
Airfoils are mounted on a motorized sting outfitted with two linear electric servo-motors.
These servos are powered by an amplifier with a integrated PID system and driven by an analog voltage input signal proportional to the desired position.

\begin{figure}[h]
  \begin{center}
%		\includegraphics{<+file+>}
  \end{center}
  \caption{Pitching and plunging mechanism}
  \label{fig:pitching_mechanism}
\end{figure}

As seen on figure \ref{fig:pitching_mechanism} combining the motion of the front and back servo allows for the wing to be plunged as well as pitched around a range of axis.
The tunnel is also equipped with a system of shutters that can be used to create wind gusts.
However this feature will not be used in this project.

\par The input signal for the servos is made with Simulink\textsuperscript{\textregistered} and fed through D-Space\textsuperscript{\textregistered} as an analog voltage.

\par Several sensors are used for data acquisition.
A pair of linear potentiometers measures the position of the servos in order to get the airfoil pitch angle.
The flow speed is measure via a Pitot tube and pressure transducer plugged into a acquisition box.
In parallel to this acquisition box the forces exerted on the airfoil can be measured.
A piezoelectric ATI Nano17 force balance seats between the sting and the airfoil.
This sensor measures both absolute forces and moments along 3 different axis.

\par The wing is made out of balsa wood with a 3D printed leading edge housing the active flow control system.
This system will be described in more detail in the appropriate chapter.
The structure is wrapped in mono-coat, a heat-shrunk plastic film.
Its chord length is 245mm its width 560mm with a NACA0009 profile.
It connects to the force balance at a point at 25 percent of the chord.
The maximum was made to keep the weight and moment of inertia as small as possible to minimize the inertial effects when the wing is moving.

\Subsection{Experimental procedure and data processing}
Different pitch input have been tried.
There was some fears at first that if the pitching axis wasn't on the axis symmetry, at the quarter chord of the airfoil, additional aerodynamic phenomenon would affect the data.
After testing different pitching input that placed the rotation axis either at the top of the front servo, at the top of the force balance or at the top of the back servo,  it was determined that the optimal way to drive the pitching mechanism was to move only the back servo.
Other input method induced to much mechanical vibrations and did not seems to make any difference aerodynamically.

\par The amplifier driving the electric servos has its own PID control system, however even after careful tunning some error exists between the commanded angle of attack and the actual angle of attack.
To negate that effect the actual servo position, as given by the potentiometers, is used for our measurements.
This data is used to transform the normal and tangent force into lift and drag (via a simple rotation matrix). 
They are then normalized to get the aerodynamics coefficients.

\par Unless specified otherwise, all the acquisitions have been done at a flow speed of 3m/s which correspond to a Reynolds number of 50000.

\par For each experimental case the force balance as well as the servo position and a synchronisation signal are simultaneously acquired.
A first offset with the tunnel off and the wing pitching is taken to let us get the force balance offset as well as record the inertial effects.
Even tho the wing is only weighing around 300 grammes, these inertial effects represent the majority of the forces measured by the force balance.
Moreover some of the force measured come from the springiness of the cables used for the active flow control part.
After the first offset the real case is taken, followed by a second offset to account for the drift in the force balance measurement sometime seen over the course of several minutes.

\par During each acquisitions at least 50 cycles are recorded.
This allows us to perform what we call phase averaging.
This is done by slicing the files into individual cycles (thank to the synchronisation signal) and then making an average of these cycles.
With this technique the signal to noise ratio of greatly improved.
Once this has been done with the 2 offsets and the proper acquisition itself, aerodynamic forces are obtained by subtracting the offsets.
All this processing is done with Matlab\textsuperscript{\textregistered}. 

\par The servo actuation system has a small but noticeable dead band as well as a delay between the input and output.
This makes the actual pitching motion slightly different from the input.
To account for that the actual measured pitch angle is used as an input of the GK model when we want to compare its prediction with the experimental data.

\par Finally the GK model itself is also implemented in Matlab.
The code can be seen in annex \ref{ch:GK_code}.

\Section{GK model adaptation}

\Subsection{Steady lift and stalling behavior}
With the basics of the GK model defined, the goal is now to adapt it to our objectives.
If this model is to be used for optimization purposes the drag also needs to be calculated.
The original model defined by Goman and Khrabrov was included the lift and pitching moment coefficients.
Similarly to their model the assumption is made that the lift and drag coefficients share the same state variable.
As such we define $f$ and $g$ as

\begin{equation}
  \begin{array}[c]{c}
    C_l=f(\alpha,x) \\
    C_d=g(\alpha,x)
  \end{array}
  \label{eqn:lift_drag_functions}
\end{equation}

\par The other difference with their case study is that we are considering a 2D airfoil whereas they modeled a 3D delta wing.
This means that we can't reuse the same lift function $f$ as the original paper.

\par In order to get an accurate equation for the lift and drag a quasi-steady map of the lift and drag coefficients is made.
This map is done by very slowly (0.1 degree per seconds) pitching the wing between -5 and 25 degrees.
The free stream speed has to be corrected to account for the flow slowing down during the higher blockage ratio at high angle of attack.

\begin{figure}[ht]
  \begin{center}
    \scalebox{0.8}
    {\includegraphics{./Figures/NACA0009_steady_map_Cl_Cd.eps}}
  \end{center}
  \caption{Lift and drag coefficient in the quasi-steady case}
  \label{fig:QS_Cl_Cd_vs_alpha}
\end{figure}

\par Figure \ref{fig:QS_Cl_Cd_vs_alpha} shows how the aerodynamics behave for our NACA0009 airfoil.
The lift coefficient is close to a clean linear function when the flow is attached.
The separation happens around 8 degrees and the lift coefficient remains constant in the 10 to 20 degrees zone when the flow is partially separated.
At higher angle of attack the flow is totally separated and $C_l$ is once again proportional to $\alpha$ but with a different slope this time.
Even though the NACA0009 has a symmetric profile the measured lift coefficient for a angle of attack of zero is not null.
It is suspected that the sting onto which the airfoil is fixed may disturb the flow and cause this asymmetry.
Moreover this curve differs slightly from the ones found in the literature.
Once again this can be attributed to the experimental setup; other than the sting effects the couple of millimeters of clearance between the wall of the wind tunnel and the edge of the airfoil are probably to blame as they induce some 3D effects.
These gaps are necessary for to allow for the both pitching and plunging of the wing.

\par From this static map we can approximate the part where the flow is still attached (<8 degrees) by 

\begin{equation}
  \begin{array}[c]{c}
    C_l= 2 \pi \cdot \alpha + C_l0 \\
    C_d= \frac{C_l^2}{2G_{max}} + C_d0
  \end{array}
  \label{eqn:attached_Cl_and_Cd_vs_alpha}
\end{equation}

Which is remarkably close to the classical theoretical result for a 2D airfoils in a ideal inviscid attached flow.

\Subsection{State variable approximation}
When the flow is still attached the value of $x$ is 1. 
This means that we are considering the separation point to be at the trailing edge.
Similarly when the flow is totally separated the separation point is at the leading edge and $x=0$.
Since for totally separated flow the slop of the lift coefficient as a function of $\alpha$ can be approximated to about $0.4$ of the slope for the attached flow, we choose to use the following equation for the lift over the whole range of angle of attack. 

\begin{equation}
  C_l(\alpha,x)=2 \pi \cdot \alpha (0.6 x + 0.4) + C_l0
  \label{eqn:Cl_function}
\end{equation}

\par From this equation the value of $x_0$ was then adjusted so that the output of this function matches the experimental data. 
The resulting profile for $x_0(\alpha)$ can be seen in figure \ref{fig:x_0_vs_alpha}

\begin{figure}[h]
  \begin{center}
    \scalebox{0.5}
    {\includegraphics{./Figures/x_0_vs_alpha.eps}}
  \end{center}
  \caption{Quasi-steady profile for the state variable $x$}
  \label{fig:x_0_vs_alpha}
\end{figure}

With this profile we get a good approximation of the experimental $C_l(\alpha)$ (cf figure \ref{fig:GK_Cl_vs_alpha}) for quasi steady cases.

\begin{figure}[h]
  \begin{center}
    \includegraphics{./Figures/GK_cl_vs_alpha.eps}
  \end{center}
  \caption{Comparison between the experimental and model quasi-steady lift}
  \label{fig:GK_Cl_vs_alpha}
\end{figure}

\par The assumption that the drag share the same state variable as the lift is confirmed when the following equation produces similarly accurate results compared to experimental data, as seen on figure \ref{fig:GK_Cd_vs_alpha}.

\begin{equation}
  C_d(\alpha,x)= \frac{ \left( \left( 2 - x \right)C_l \right)^2 }{2 G_{max}} + C_d0
  \label{eqn:Cd_function}
\end{equation}

\begin{figure}[h]
  \begin{center}
    \scalebox{0.6}
    {\includegraphics{./Figures/GK_cd_vs_alpha.eps}}
  \end{center}
  \caption{Comparison between the experimental and model quasi-steady drag}
  \label{fig:GK_Cd_vs_alpha}
\end{figure}

\par These two relatively simple equations shows that a physics based GK model can be implemented for both lift and drag and that they indeed depend on the same state variable.
The two time constants $\tau_1$ and $\tau_2$ will be determined in the next section when the wing undergo unsteady pithing.

\Section{Model validation}

\par While the ability to predict lift and drag based on separation can be useful, the real strength of the GK model resides in its ability to work on unsteady cases.
The first step is to determine the 2 $\tau$ time constants. 
To do that a series of pitching cases are performed. 
The pitching inputs are the following

\begin{equation}
  \alpha\left( t \right)= A \sin \left( 2 \pi \frac{t}{f} \right) + \alpha_0
  \label{eqn:pitch_input}
\end{equation}

With $A=2^\circ$ and $\alpha_0=12^\circ$.
The frequency $f$ is set to 0.25, 0.5, 1 and 2 Hz (respectively K of 0.064, 0.128, 0.257 and 0.513)

\begin{figure}[h]
  \begin{center}
    \scalebox{0.6}  
    {\includegraphics{./Figures/Pitching_allcases_CL_12_amp_2.eps}}
  \end{center}
  \caption{Unsteady effects of sinusoidal pitching on the lift}
  \label{fig:Pitching_allcases_Cl}
\end{figure}


% put both sinusoidal and ``random'' motion
% Also try a non dimensional validation

\par This model is producing accurate results that account for both the dynamic effects and the flow separation.
Moreover the procedure is light enough to be implemented into the optimization algorithm without increasing too much the computation cost.
